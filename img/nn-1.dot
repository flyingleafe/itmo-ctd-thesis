digraph basic_nn {
node [shape=none]; 
    
    d_input [label=<<table border="0" cellspacing="0" cellborder="1" cellpadding="5">
                      <tr border="0">
                        <td>0</td>
                        <td>0</td>
                        <td>0</td>
                        <td>0</td>
                        <td>1</td>
                      </tr>
                  </table>>];
    s_input [label=<<table border="0" cellspacing="0"  cellpadding="5">
                      <tr border="0">
                        <td border="1">1</td>
                        <td border="1">0</td>
                        <td border="1">0</td>
                        <td border="1">0</td>
                        <td border="1">0</td>
                      </tr>
                  </table>>]; 
    y_input [label=<<table border="0" cellspacing="0" cellpadding="5">
                      <tr border="0">
                        <td border="1">0</td>
                        <td border="1">1</td>
                        <td border="1">1</td>
                        <td border="1">0</td>
                        <td border="1">0</td>
                      </tr>
                  </table>>];
    
    subgraph {
      {rank=same; d_input, s_input, y_input} 
    }

node [shape="box"]
    layer_1 [label="fully-connected, 64 units"];
    layer_2 [label="fully-connected, 64 units"];
    layer_3 [label="fully-connected, 5 units"];

    sum [shape="circle", label="+"]

    output [shape=none, label=<<table border="0" cellspacing="0" cellpadding="5">
                      <tr border="0">
                        <td border="1">-∞</td>
                        <td border="1">q<SUB>2</SUB></td>
                        <td border="1">q<SUB>3</SUB></td>
                        <td border="1">-∞</td>
                        <td border="1">-∞</td>
                      </tr>
                  </table>>];

    d_input -> layer_1
    s_input -> layer_1
    y_input -> layer_1

    y_input -> sum [label="  if y = 0 then -∞ else 0", constraint=false]

    layer_1 -> layer_2 [label="  ReLU"]
    layer_2 -> layer_3 [label="  ReLU"]
    layer_3 -> sum [label="  linear"]
    
    sum -> output

edge [style="invis"]
    d_input -> s_input -> y_input
}
